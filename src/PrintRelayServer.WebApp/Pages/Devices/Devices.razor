@page "/Devices"
@inherits DevicesBase

<PageTitle>Devices</PageTitle>

<div class="container mx-auto p-4">
    <FluentStack Orientation="Orientation.Vertical" VerticalGap="15">
        <div class="flex justify-between items-center mb-4">
            <h1 class="text-2xl font-bold text-gray-800">Devices</h1>
            <FluentButton Appearance="Appearance.Accent" 
                         IconStart="@(new Icons.Regular.Size20.Add())"
                         OnClick="@(() => ShowAddDialog = true)"
                         class="bg-blue-600 hover:bg-blue-700">
                Add Device
            </FluentButton>
        </div>

        @if (IsLoading)
        {
            <FluentProgressRing />
        }
        else
        {
            <div class="bg-white rounded-lg shadow">
                <FluentDataGrid Items="@Devices" ResizableColumns="true" class="min-h-[400px]">
                    <FluentDataGridColumns>
                        <FluentDataGridColumn Title="Name" Field="@(nameof(GetDevice.Name))" />
                        <FluentDataGridColumn Title="Code" Field="@(nameof(GetDevice.Code))" />
                        <FluentDataGridColumn Title="OS" Field="@(nameof(GetDevice.OsIdentifier))" />
                        <FluentDataGridColumn Title="Owner" Field="@(c => c.Owner.Name)" />
                        <FluentDataGridColumn Title="Device Type" Field="@(c => c.DeviceType.DeviceTypeName)" />
                        <FluentDataGridColumn Title="Actions">
                            <ColumnTemplate>
                                <div class="flex gap-2">
                                    <FluentButton IconStart="@(new Icons.Regular.Size20.Edit())"
                                                 OnClick="@(() => EditDevice(context.Item))"
                                                 class="text-blue-600 hover:text-blue-700">
                                        Edit
                                    </FluentButton>
                                    <FluentButton IconStart="@(new Icons.Regular.Size20.Delete())"
                                                 OnClick="@(() => DeleteDevice(context.Item))"
                                                 class="text-red-600 hover:text-red-700">
                                        Delete
                                    </FluentButton>
                                </div>
                            </ColumnTemplate>
                        </FluentDataGridColumn>
                    </FluentDataGridColumns>
                </FluentDataGrid>
            </div>
        }
    </FluentStack>
</div>

@if (ShowAddDialog)
{
    <FluentDialog Modal="true" @bind-Visible="ShowAddDialog">
        <!-- Add Device Form -->
    </FluentDialog>
}

@if (ShowEditDialog)
{
    <FluentDialog Modal="true" @bind-Visible="ShowEditDialog">
        <!-- Edit Device Form -->
    </FluentDialog>
}